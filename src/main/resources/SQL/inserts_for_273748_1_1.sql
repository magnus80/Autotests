declare
ctn varchar2(100); 
subscr_no varchar2(100);
account_no varchar2(100);
executeCallHistoryStmt varchar2(5000);
CallHistoryTablePrefix_AB varchar2(100);
iterator number;
exitStmt number;
begin
ctn:='79030371111';
exitStmt:=6;
iterator:=0;
select subscr_no into subscr_no from account_subscriber where range_map_external_id=ctn;
select account_no into account_no from account_subscriber where range_map_external_id=ctn;

execute immediate 'select table_ab  from INSERT_CONTROL where table_name=''CALL_HISTORY'' and  active_set=''Y''' into CallHistoryTablePrefix_AB;
--CALL_HISTORY
loop
executeCallHistoryStmt:='Insert into CALL_HISTORY_MAIN_'||CallHistoryTablePrefix_AB||'
   (SUBSCR_NO_RESETS, SUBSCR_NO, ACCOUNT_NO, PARENT_ACCOUNT_NO, START_CALL_DATE_TIME, END_CALL_DATE_TIME, USAGE_AMOUNT, EXTERNAL_ID_TYPE, EXTERNAL_ID, RESELLER_ID, APN_ID, QOS_ID, UNIT_TYPE_ID, SLU_ID, CELL_ID, MSC_ID, SUBTYPE_ID, APPLICATION_ID, ADDITIONAL_NUMBER, REASON_CODE, DESCRIPT, FINAL_AUT_ID, INITIAL_AUT_ID, CALLED_NUMBER, TARGET_ACCOUNT_NO, ACTIVITY_TYPE, CIRCLE_ID, CONV_RATE_TO_BILLED_ACCOUNT, BILLED_ACCOUNT_CURRENCY, BILLED_ACCOUNT_TML_CHANGE, BILLED_ACCOUNT_TML_VALUE, CONVERSION_RATE_TO_SUB, RATE_CURRENCY, SUBSCRIBER_CURRENCY, CHARGE_CODE, ORP_TIME, CRN, LIABILITY_REDIRECT_INDICATOR, USER_SUBSCR_NO_RESETS, USER_SUBSCR_NO, SPLIT_ROW_NUM, MSG_ID2, MSG_ID, PRE_ISO_CODE, GSM_PROVIDER_ID, PRE_CHARGE, MARKUP_PERCENT, BAL_INFO, ACCU_INFO, ACCT_ACCU_INFO, ACCT_BAL_INFO, EXT_FIELD, TIMEZONE, NETWORK_PORTING_PREFIX, ACTUAL_ORIGINATING_NUMBER, ACTUAL_DESTINATION_NUMBER, ROUNDED_DURATION, START_CALL_DATE_TIME_SUB_TZ, END_CALL_DATE_TIME_SUB_TZ, INCOMING_CALL_ID, OUTGOING_CALL_ID, RECORD_SOURCE, EXT_USSD_RESP_USED, USSD_RESPONSE_CODE, MOG_ID, TARIFF_PLAN_ID, ORIG_TARIFF_PLAN_ID, USAGE_OFFER_ID, GROUP_ACCOUNT_INFO, TARGET_SUBSCR_NO, TARGET_SUBSCR_NO_RESETS, GROUP_ACCOUNT_TYPE, FUND_USAGE_TYPE, CA_EXTERNAL_ID, IS_SP_RATED_TRANSACTION, CHANGES_IN_BALS_CHARGED, PCL_FLAG)
 Values
   (0, '||subscr_no||', '||account_no||', NULL,sysdate+('||iterator||'/24/60), 
    sysdate+('||(iterator+1)||'/24/60), 360, 1, ''79031264060'', 0, 
    NULL, NULL, 2, ''4'', ''250996500803592'', 
    ''CCBOtest'', 418, 1, NULL, 407, 
    NULL, 394, 1, ''79031440050'', NULL, 
    ''OUTGOING_OPPS_CALL'', NULL, 1, ''RUR'', NULL, 
    NULL, 1, ''RUR'', ''RUR'', ''104'', 
    sysdate, 98371, NULL, NULL, NULL, 
    NULL, 56860001, 496304708, ''RUR'', NULL, 
    NULL, NULL, ''[1~100.0000~5.0000~0][2~0.0000~0.0000~0][3~0.0000~0.0000~0][4~0.0000~0.0000~0][5~0.0000~0.0000~0][6~0.0000~0.0000~0][7~0.0000~0.0000~0][8~0.0000~0.0000~0][9~0.0000~0.0000~0][10~0.0000~0.0000~0][11~0.0000~0.0000~0][12~0.0000~0.0000~0][13~0.0000~0.0000~0][14~0.0000~0.0000~0][15~0.0000~0.0000~0][16~0.0000~0.0000~0][17~0.0000~0.0000~0][18~0.0000~0.0000~0][19~0.0000~0.0000~0][20~0.0000~0.0000~0]'',
    ''[14~0.000000~0.000000][19~0.000000~0.000000][21~0.000000~0.000000][22~0.000000~0.000000][25~0.000000~0.000000][27~0.000000~0.000000][28~0.000000~0.000000][29~0.000000~0.000000][30~0.000000~0.000000][33~0.000000~0.000000][46~0.000000~0.000000][47~0.000000~0.000000][48~0.000000~0.000000][77~0.000000~0.000000][78~0.000000~0.000000][126~0.000000~0.000000][135~0.000000~0.000000][145~0.000000~0.000000][146~0.000000~0.000000][321~0.000000~0.000000][330~0.000000~0.000000][331~0.000000~0.000000][370~0.000000~0.000000][457~0.000000~0.000000][506~0.000000~0.000000][566~0.000000~0.000000]'', NULL, 
    NULL, NULL, 1, NULL, ''79031264060'', 
    ''79031440050'', 0, sysdate, sysdate, NULL, 
    NULL, 1, 0, NULL, 4, 
    5105, NULL, 62, NULL, NULL, 
    NULL, 6, 1, NULL, 0, 
    NULL, 0)';
iterator:=iterator+1;
exit when iterator>exitStmt;
execute immediate executeCallHistoryStmt;
end loop;
commit;
end;